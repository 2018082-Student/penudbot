%% Linearization for XIN parameters
%A = [  0. ,          0.   ,        1. ,          0.       ;
%      0. ,          0.  ,         0.   ,        1. ;       
%     66.92543707, -24.85410405,   0. ,          0. ;       
%    -68.60106464, 105.43372561 ,  0. ,          0.        ];
% 
% B = [  0.        ;
%       0.        ;
%      44.87152352;
%     -85.08656818];

A = [  0. ,          0.   ,        1. ,          0.       ;
     0. ,          0.  ,         0.   ,        1. ;       
    25.22571429, -25.22571429,   0. ,          0. ;       
    -33.63428571  92.49428571 ,  0. ,          0.        ];

B = [  0.        ;
      0.        ;
     6.85714286;
    -17.14285714];

q = [1 1 1 1];
Q = diag(q);

R = 1 ;

[K,S,P] = lqr(A,B,Q,R)
